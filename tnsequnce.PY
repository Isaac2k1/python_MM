# --------------------------------------------------------------------
# -- Python Script File
# -- Created on 2021-12-02 12:10:33
# -- Author: username
# -- Comment: .
# --------------------------------------------------------------------
import sys
if 'DIAdem' in sys.modules:
    from DIAdem import Application as dd

    if False:
        import DIAdem_CodeCompletion as dd

#    if dd.AppEnableScriptDebugger:
#        import debugpy
#        debugpy.configure(python = sys.prefix + '\\python.exe')
#        if not debugpy.is_client_connected():
#            try:
#                debugpy.listen(5678)
#            except:
#                pass
#            debugpy.wait_for_client()

# --------------------------------------------------------------------
# -- Beginning of user code --
"""
['m18000098-0001.rbe', 'm18000098-0002.rbe', 'm18000098-0003.rbe', 'm18000098-0004.rbe', 'm18000098-0005.rbe', 'm18000098-0006.rbe', 'm18000098-0007.rbe', 'm18000098-0008.rbe', 'm18000098-0009.rbe', 'm18000098-0010.rbe', 'm18000098-0011.rbe', 'm18000098-0012.rbe', 'm18000098-0013.rbe', 'm18000098-0014.rbe', 'm18000098-0015.rbe', 'm18000098-0016.rbe', 'm18000098-0017.rbe', 'm18000098-0018.rbe', 'm18000098-0019.rbe', 'm18000098-0020.rbe', 'm18000098-0021.rbe', 'm18000098-0022.rbe', 'm18000098-0023.rbe', 'm18000098-0024.rbe', 'm18000098-0025.rbe', 'm18000098-0026.rbe', 'm18000098-0027.rbe', 'm18000098-0028.rbe', 'm18000098-0029.rbe', 'm18000098-0030.rbe', 'm18000098-0031.rbe', 'm18000098-0032.rbe', 'm18000098-0033.rbe', 'm18000098-0034.rbe', 'm18000098-0035.rbe', 'm18000098-0036.rbe', 'm18000098-0037.rbe', 'm18000098-0038.rbe', 'm18000098-0039.rbe', 'm18000098-0040.rbe', 'm18000098-0041.rbe', 'm18000098-0042.rbe', 'm18000098-0043.rbe', 'm18000098-0044.rbe', 'm18000098-0045.rbe', 'm18000098-0046.rbe', 'm18000098-0047.rbe', 'm18000098-0048.rbe', 'm18000098-0049.rbe', 'm18000098-0050.rbe', 'm18000098-0051.rbe', 'm18000098-0052.rbe', 'm18000098-0053.rbe', 'm18000098-0054.rbe', 'm18000098-0055.rbe', 'm18000098-0056.rbe', 'm18000098-0057.rbe', 'm18000098-0058.rbe', 'm18000098-0059.rbe', 'm18000098-0060.rbe', 'm18000098-0061.rbe', 'm18000098-0062.rbe', 'm18000098-0063.rbe', 'm18000098-0064.rbe', 'm18000098-0065.rbe', 'm18000098-0066.rbe', 'm18000098-0067.rbe', 'm18000098-0068.rbe', 'm18000098-0069.rbe', 'm18000098-0070.rbe', 'm18000098-0071.rbe', 'm18000098-0072.rbe', 'm18000098-0073.rbe', 'm18000098-0074.rbe', 'm18000098-0075.rbe', 'm18000098-0076.rbe', 'm18000098-0077.rbe', 'm18000098-0078.rbe', 'm18000098-0079.rbe', 'm18000098-0080.rbe', 'm18000098-0081.rbe', 'm18000098-0082.rbe', 'm18000098-0083.rbe', 'm18000098-0084.rbe', 'm18000098-0085.rbe', 'm18000098-0086.rbe', 'm18000098-0087.rbe', 'm18000098-0088.rbe', 'm18000098-0089.rbe', 'm18000098-0090.rbe', 'm18000098-0091.rbe', 'm18000098-0092.rbe', 'm18000098-0093.rbe', 'm18000098-0094.rbe', 'm18000098-0095.rbe', 'm18000098-0096.rbe', 'm18000098-0097.rbe', 'm18000098-0098.rbe', 'm18000098-0099.rbe', 'm18000098-0100.rbe', 'm18000098-0101.rbe', 'm18000098-0102.rbe', 'm18000098-0103.rbe', 'm18000098-0104.rbe', 'm18000098-0105.rbe', 'm18000098-0106.rbe', 'm18000098-0107.rbe', 'm18000098-0108.rbe', 'm18000098-0109.rbe', 'm18000098-0110.rbe', 'm18000098-0111.rbe', 'm18000098-0112.rbe', 'm18000098-0113.rbe', 'm18000098-0114.rbe', 'm18000098-0115.rbe', 'm18000098-0116.rbe', 'm18000098-0117.rbe', 'm18000098-0118.rbe', 'm18000098-0119.rbe', 'm18000098-0120.rbe', 'm18000098-0121.rbe', 'm18000098-0122.rbe', 'm18000098-0123.rbe', 'm18000098-0124.rbe', 'm18000098-0125.rbe', 'm18000098-0126.rbe', 'm18000098-0127.rbe', 'm18000098-0128.rbe', 'm18000098-0129.rbe', 'm18000098-0130.rbe', 'm18000098-0131.rbe', 'm18000098-0132.rbe', 'm18000098-0133.rbe', 'm18000098-0134.rbe', 'm18000098-0135.rbe', 'm18000098-0136.rbe', 'm18000098-0137.rbe', 'm18000098-0138.rbe', 'm18000098-0139.rbe', 'm18000098-0140.rbe', 'm18000098-0141.rbe', 'm18000098-0142.rbe', 'm18000098-0143.rbe', 'm18000098-0144.rbe', 'm18000098-0145.rbe', 'm18000098-0146.rbe', 'm18000098-0147.rbe', 'm18000098-0148.rbe', 'm18000098-0149.rbe', 'm18000098-0150.rbe', 'm18000098-0151.rbe', 'm18000098-0152.rbe', 'm18000098-0153.rbe', 'm18000098-0154.rbe', 'm18000098-0155.rbe', 'm18000098-0156.rbe', 'm18000098-0157.rbe', 'm18000098-0158.rbe', 'm18000098-0159.rbe', 'm18000098-0160.rbe', 'm18000098-0161.rbe', 'm18000098-0162.rbe', 'm18000098-0163.rbe', 'm18000098-0164.rbe', 'm18000098-0165.rbe', 'm18000098-0166.rbe', 'm18000098-0167.rbe', 'm18000098-0168.rbe', 'm18000098-0169.rbe', 'm18000098-0170.rbe', 'm18000098-0171.rbe', 'm18000098-0172.rbe', 'm18000098-0173.rbe', 'm18000098-0174.rbe', 'm18000098-0175.rbe', 'm18000098-0176.rbe', 'm18000098-0177.rbe', 'm18000098-0178.rbe', 'm18000098-0179.rbe', 'm18000098-0180.rbe', 'm18000098-0181.rbe', 'm18000098-0182.rbe', 'm18000098-0183.rbe', 'm18000098-0184.rbe', 'm18000098-0185.rbe', 'm18000098-0186.rbe', 'm18000098-0187.rbe', 
'm18000098-0188.rbe', 'm18000098-0189.rbe', 'm18000098-0190.rbe', 'm18000098-0191.rbe', 'm18000098-0192.rbe', 'm18000098-0193.rbe', 'm18000098-0194.rbe', 'm18000098-0195.rbe', 'm18000098-0196.rbe', 'm18000098-0197.rbe', 'm18000098-0198.rbe', 'm18000098-0199.rbe', 'm18000098-0200.rbe', 'm18000098-0201.rbe', 'm18000098-0202.rbe', 'm18000098-0203.rbe', 'm18000098-0204.rbe', 'm18000098-0205.rbe', 'm18000098-0206.rbe', 'm18000098-0207.rbe', 'm18000098-0208.rbe', 'm18000098-0209.rbe', 'm18000098-0210.rbe', 'm18000098-0211.rbe', 'm18000098-0212.rbe', 'm18000098-0213.rbe', 'm18000098-0214.rbe', 'm18000098-0215.rbe', 'm18000098-0216.rbe', 'm18000098-0217.rbe', 'm18000098-0218.rbe', 'm18000098-0219.rbe', 'm18000098-0220.rbe', 'm18000098-0221.rbe', 'm18000098-0222.rbe', 'm18000098-0223.rbe', 'm18000098-0224.rbe', 'm18000098-0225.rbe', 'm18000098-0226.rbe', 'm18000098-0227.rbe', 'm18000098-0228.rbe', 'm18000098-0229.rbe', 'm18000098-0230.rbe', 'm18000098-0231.rbe', 'm18000098-0232.rbe', 'm18000098-0233.rbe', 'm18000098-0234.rbe', 'm18000098-0235.rbe', 'm18000098-0236.rbe', 'm18000098-0237.rbe', 'm18000098-0238.rbe', 'm18000098-0239.rbe', 'm18000098-0240.rbe', 'm18000098-0241.rbe', 'm18000098-0242.rbe', 'm18000098-0243.rbe', 'm18000098-0244.rbe', 'm18000098-0245.rbe', 'm18000098-0246.rbe', 'm18000098-0247.rbe', 'm18000098-0248.rbe', 'm18000098-0249.rbe', 'm18000098-0250.rbe', 'm18000098-0251.rbe', 'm18000098-0252.rbe', 'm18000098-0253.rbe', 'm18000098-0254.rbe', 'm18000098-0255.rbe', 'm18000098-0256.rbe', 'm18000098-0257.rbe', 'm18000098-0258.rbe', 'm18000098-0259.rbe', 'm18000098-0260.rbe', 'm18000098-0261.rbe', 'm18000098-0262.rbe', 'm18000098-0263.rbe', 'm18000098-0264.rbe', 'm18000098-0265.rbe', 'm18000098-0266.rbe', 'm18000098-0267.rbe', 'm18000098-0268.rbe', 'm18000098-0269.rbe', 'm18000098-0270.rbe', 'm18000098-0271.rbe', 'm18000098-0272.rbe', 'm18000098-0273.rbe', 'm18000098-0274.rbe', 'm18000098-0275.rbe', 'm18000098-0276.rbe', 'm18000098-0277.rbe', 'm18000098-0278.rbe', 'm18000098-0279.rbe', 'm18000098-0280.rbe', 'm18000098-0281.rbe', 'm18000098-0282.rbe', 'm18000098-0283.rbe', 'm18000098-0284.rbe', 'm18000098-0285.rbe', 'm18000098-0286.rbe', 'm18000098-0287.rbe', 'm18000098-0288.rbe', 'm18000098-0289.rbe', 'm18000098-0290.rbe', 'm18000098-0291.rbe', 'm18000098-0292.rbe', 'm18000098-0293.rbe', 'm18000098-0294.rbe', 'm18000098-0295.rbe', 'm18000098-0296.rbe', 'm18000098-0297.rbe', 'm18000098-0298.rbe', 'm18000098-0299.rbe', 'm18000098-0300.rbe', 'm18000098-0301.rbe', 'm18000098-0302.rbe', 'm18000098-0303.rbe', 'm18000098-0304.rbe', 'm18000098-0305.rbe', 'm18000098-0306.rbe', 'm18000098-0307.rbe', 'm18000098-0308.rbe', 'm18000098-0309.rbe', 'm18000098-0310.rbe', 'm18000098-0311.rbe', 'm18000098-0312.rbe', 'm18000098-0313.rbe', 'm18000098-0314.rbe', 'm18000098-0317.rbe', 'm18000098-0318.rbe', 'm18000098-0319.rbe', 'm18000098-0320.rbe', 'm18000098-0321.rbe', 'm18000098-0322.rbe', 'm18000098-0323.rbe', 'm18000098-0324.rbe', 'm18000098-0325.rbe', 'm18000098-0326.rbe', 'm18000098-0327.rbe', 'm18000098-0328.rbe', 'm18000098-0329.rbe', 'm18000098-0330.rbe', 'm18000098-0331.rbe', 'm18000098-0332.rbe', 'm18000098-0333.rbe', 'm18000098-0334.rbe', 'm18000098-0335.rbe', 'm18000098-0336.rbe', 'm18000098-0337.rbe', 'm18000098-0338.rbe', 'm18000098-0339.rbe', 'm18000098-0342.rbe', 'm18000098-0343.rbe', 'm18000098-0344.rbe', 'm18000098-0345.rbe', 'm18000098-0346.rbe', 'm18000098-0347.rbe', 'm18000098-0348.rbe', 'm18000098-0349.rbe', 'm18000098-0350.rbe', 'm18000098-0351.rbe', 'm18000098-0352.rbe', 'm18000098-0353.rbe', 'm18000098-0354.rbe', 'm18000098-0355.rbe', 'm18000098-0356.rbe', 'm18000098-0357.rbe', 'm18000098-0358.rbe', 'm18000098-0359.rbe', 'm18000098-0360.rbe', 'm18000098-0361.rbe', 'm18000098-0362.rbe', 'm18000098-0363.rbe', 'm18000098-0364.rbe', 'm18000098-0365.rbe', 'm18000098-0366.rbe', 'm18000098-0367.rbe', 'm18000098-0368.rbe', 'm18000098-0369.rbe', 'm18000098-0370.rbe', 'm18000098-0371.rbe', 'm18000098-0372.rbe', 'm18000098-0373.rbe', 'm18000098-0374.rbe', 'm18000098-0375.rbe', 'm18000098-0376.rbe', 'm18000098-0377.rbe', 'm18000098-0378.rbe', 'm18000098-0379.rbe', 
'm18000098-0380.rbe', 'm18000098-0381.rbe', 'm18000098-0382.rbe', 'm18000098-0383.rbe', 'm18000098-0384.rbe', 'm18000098-0385.rbe', 'm18000098-0386.rbe', 'm18000098-0387.rbe', 'm18000098-0388.rbe', 'm18000098-0389.rbe', 'm18000098-0390.rbe', 'm18000098-0391.rbe', 'm18000098-0392.rbe', 'm18000098-0393.rbe', 'm18000098-0394.rbe', 'm18000098-0395.rbe', 'm18000098-0396.rbe', 'm18000098-0397.rbe', 'm18000098-0398.rbe', 'm18000098-0399.rbe', 'm18000098-0400.rbe', 'm18000098-0401.rbe', 'm18000098-0402.rbe', 'm18000098-0403.rbe', 'm18000098-0404.rbe', 'm18000098-0405.rbe', 'm18000098-0406.rbe', 'm18000098-0407.rbe', 'm18000098-0408.rbe', 'm18000098-0409.rbe', 'm18000098-0411.rbe', 'm18000098-0412.rbe', 'm18000098-0413.rbe', 'm18000098-0414.rbe', 'm18000098-0415.rbe', 'm18000098-0416.rbe', 'm18000098-0417.rbe', 'm18000098-0418.rbe', 'm18000098-0419.rbe', 'm18000098-0420.rbe', 'm18000098-0421.rbe', 'm18000098-0422.rbe', 'm18000098-0423.rbe', 'm18000098-0424.rbe', 'm18000098-0425.rbe', 'm18000098-0426.rbe', 'm18000098-0427.rbe', 'm18000098-0428.rbe', 'm18000098-0429.rbe', 'm18000098-0430.rbe', 'm18000098-0431.rbe', 'm18000098-0432.rbe', 'm18000098-0433.rbe', 'm18000098-0434.rbe', 'm18000098-0435.rbe', 'm18000098-0436.rbe', 'm18000098-0437.rbe', 'm18000098-0438.rbe', 'm18000098-0439.rbe', 'm18000098-0440.rbe', 'm18000098-0441.rbe', 'm18000098-0442.rbe', 'm18000098-0443.rbe', 'm18000098-0444.rbe', 'm18000098-0445.rbe', 'm18000098-0446.rbe', 'm18000098-0447.rbe', 'm18000098-0448.rbe', 'm18000098-0449.rbe', 'm18000098-0450.rbe', 'm18000098-0451.rbe', 'm18000098-0452.rbe', 'm18000098-0453.rbe', 'm18000098-0454.rbe', 'm18000098-0455.rbe', 'm18000098-0456.rbe', 'm18000098-0457.rbe', 'm18000098-0458.rbe', 'm18000098-0459.rbe', 'm18000098-0460.rbe', 'm18000098-0461.rbe', 'm18000098-0462.rbe', 'm18000098-0463.rbe', 'm18000098-0464.rbe', 'm18000098-0465.rbe', 'm18000098-0466.rbe', 'm18000098-0467.rbe', 'm18000098-0468.rbe', 'm18000098-0469.rbe', 'm18000098-0470.rbe', 'm18000098-0471.rbe', 'm18000098-0472.rbe', 'm18000098-0473.rbe', 'm18000098-0474.rbe', 'm18000098-0475.rbe', 'm18000098-0476.rbe', 'm18000098-0477.rbe', 'm18000098-0478.rbe', 'm18000098-0479.rbe', 'm18000098-0480.rbe', 'm18000098-0481.rbe', 'm18000098-0482.rbe', 'm18000098-0483.rbe', 'm18000098-0484.rbe', 'm18000098-0485.rbe', 'm18000098-0486.rbe', 'm18000098-0487.rbe', 'm18000098-0488.rbe', 'm18000098-0489.rbe', 'm18000098-0490.rbe', 'm18000098-0491.rbe', 'm18000098-0492.rbe', 'm18000098-0493.rbe', 'm18000098-0494.rbe', 'm18000098-0495.rbe', 'm18000098-0496.rbe', 'm18000098-0497.rbe', 'm18000098-0498.rbe', 'm18000098-0499.rbe', 'm18000098-0500.rbe', 'm18000098-0501.rbe', 'm18000098-0502.rbe', 'm18000098-0503.rbe', 'm18000098-0504.rbe', 'm18000098-0505.rbe', 'm18000098-0506.rbe', 'm18000098-0507.rbe', 'm18000098-0508.rbe', 'm18000098-0509.rbe', 'm18000098-0510.rbe', 'm18000098-0511.rbe', 'm18000098-0512.rbe', 'm18000098-0513.rbe', 'm18000098-0514.rbe', 'm18000098-0515.rbe', 'm18000098-0516.rbe', 'm18000098-0517.rbe', 'm18000098-0518.rbe', 'm18000098-0519.rbe', 'm18000098-0520.rbe', 'm18000098-0521.rbe', 'm18000098-0522.rbe', 'm18000098-0523.rbe', 'm18000098-0524.rbe', 'm18000098-0001.rbd']
"""
oMyChannelGroups = dd.Data.GetChannelgroups("*") # Get all channelgroup names

from itertools import groupby
from operator import itemgetter

tn = []
print('==========================')
print(len(oMyChannelGroups))
for oMyChnGrp in oMyChannelGroups: 
    tn.append(oMyChnGrp.Properties("name").Value)

print("RBD files: ", tn.count("m18000098-0001.rbd"))
all_tn = []
for shot in tn:
    all_tn.append(int(shot.split('-')[1].split('.')[0]))
   
ranges = []
for k,g in groupby(enumerate(all_tn),lambda x:x[0]-x[1]):
    group = (map(itemgetter(1),g))
    group = list(map(int,group))
    ranges.append((group[0],group[-1]))

print('SN: ', tn[0].split('-')[0])
print(ranges)